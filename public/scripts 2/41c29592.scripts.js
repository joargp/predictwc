"use strict";angular.module("predictwcApp",["ngCookies","ngResource","ngSanitize","ngRoute"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/profile",{templateUrl:"views/profile.html",controller:"ProfileCtrl"}).when("/groups",{templateUrl:"views/groups.html",controller:"GroupsCtrl"}).when("/countries",{templateUrl:"views/countries.html",controller:"CountriesCtrl"}).when("/matches",{templateUrl:"views/matches.html",controller:"MatchesCtrl"}).when("/bets",{templateUrl:"views/bets.html",controller:"BetsCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("predictwcApp").controller("MainCtrl",["$scope","$http","countries",function(a,b,c){c.getAll().then(function(b){a.countries=b})}]),angular.module("predictwcApp").controller("ProfileCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("predictwcApp").controller("GroupsCtrl",["$scope","groups",function(a,b){b.getAll().then(function(b){a.groups=b})}]),angular.module("predictwcApp").controller("LoginCtrl",["$scope","$location",function(a,b){a.loggedInUser=void 0,dpd.users.me(function(c){a.loggedInUser=c,c&&b.path("bets"),console.log(c)}),a.createUser=function(a,b){dpd.users.post({username:a,password:b},function(a,b){return b?console.log(b):void console.log(a)})},a.loginUser=function(c,d){dpd.users.login({username:c,password:d},function(b,c){return c?console.log(c):(console.log(b),void(a.loggedInUser=b))}),b.path("bets")}}]),angular.module("predictwcApp").factory("countries",["$q",function(a){return{getAll:function(){var b=a.defer();return dpd.countries.get({$sort:{name:1}},function(a){b.resolve(a)}),b.promise},add:function(b){var c=a.defer();return dpd.countries.post({name:b.name,groupId:b.groupId,flagCode:b.flagCode},function(a){c.resolve(a)}),c.promise}}}]),angular.module("predictwcApp").factory("groups",["$q",function(a){return{getAll:function(){var b=a.defer();return dpd.groups.get(function(a){b.resolve(a)}),b.promise}}}]),angular.module("predictwcApp").directive("flag",function(){return{templateUrl:"/views/directives/flag.html",restrict:"E"}}),angular.module("predictwcApp").directive("flagIcon",function(){return{templateUrl:"/views/directives/flag-icon.html",restrict:"E"}}),angular.module("predictwcApp").controller("CountriesCtrl",["$scope","countries","groups",function(a,b,c){b.getAll().then(function(b){a.countries=b}),c.getAll().then(function(b){a.groups=b}),a.country={name:"",groupId:"",flagCode:""},a.addCountry=function(c){b.add(c).then(function(b){a.countries.unshift(b)})}}]),angular.module("predictwcApp").controller("MatchesCtrl",["$scope","matches","countries",function(a,b,c){c.getAll().then(function(b){a.countries=b}),b.getAll().then(function(b){a.matches=b}),a.match={homeTeam:"",awayTeam:"",time:"",date:""},a.addMatch=function(c){c.startTime=new Date(c.date+" "+c.time).getTime(),b.add(c).then(function(b){a.matches.unshift(b)})}}]),angular.module("predictwcApp").factory("matches",["$q",function(a){return{getAll:function(){var b=a.defer();return dpd.matches.get({$sort:{startTime:1}},function(a){b.resolve(a)}),b.promise},add:function(b){var c=a.defer();return dpd.matches.post({awayTeamId:b.awayTeamId,homeTeamId:b.homeTeamId,startTime:b.startTime},function(a){c.resolve(a)}),c.promise}}}]),angular.module("predictwcApp").controller("BetsCtrl",["$scope","matches","bets",function(a,b,c){b.getAll().then(function(b){a.matches=b}),a.addBet=function(a,b){console.log(b),c.add(a).then(function(){a.locked=!0})}}]),angular.module("predictwcApp").factory("bets",["$q",function(a){return{getAll:function(){var b=a.defer();return dpd.matches.get(function(a){b.resolve(a)}),b.promise},add:function(b){var c=a.defer();return console.log(b),dpd.bets.post({homeScore:b.chosenHomeScore,awayScore:b.chosenAwayScore,matchId:b.id},function(a,b){return b?console.log(b):void c.resolve(a)}),c.promise}}}]);